{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-28T18:38:48.509932Z", "invocation_id": "8b838cc3-480a-47b8-a30b-77b19e7cba37", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:46.235047Z", "completed_at": "2025-05-28T18:38:46.235049Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:46.235255Z", "completed_at": "2025-05-28T18:38:48.080361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8462443351745605, "adapter_response": {"_message": "CREATE 62516", "code": "CREATE", "rows_affected": 62516}, "message": "CREATE 62516", "failures": null, "unique_id": "seed.consumer_complaints.consumer_complaints", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.084618Z", "completed_at": "2025-05-28T18:38:48.091183Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.091445Z", "completed_at": "2025-05-28T18:38:48.340445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.25667452812194824, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.consumer_complaints.stg_consumer_complaints", "compiled": true, "compiled_code": "with source as (\n\n    select * from \"dev\".\"main\".\"consumer_complaints\"\n    qualify row_number() over (partition by complaint_id order by date_received desc) = 1\n),\n\ncleaned as (\n\n    select\n        cast(complaint_id as bigint) as complaint_id,\n        cast(date_submitted as date) as date_submitted,\n        cast(date_received as date) as date_received,\n        upper(trim(state)) as state,\n        lower(trim(product)) as product,\n        lower(trim(sub_product)) as sub_product,\n        lower(trim(issue)) as issue,\n        lower(trim(sub_issue)) as sub_issue,\n        lower(trim(submitted_via)) as submitted_via,\n        lower(trim(company_response_to_consumer)) as company_response_to_consumer,\n        coalesce(lower(trim(company_public_response)), 'no_public_response') as company_public_response,\n\n        -- Derived columns\n        case \n            when lower(trim(submitted_via)) in ('web', 'email') then 'digital'\n            when lower(trim(submitted_via)) in ('phone', 'fax') then 'phone'\n            else 'other'\n        end as contact_channel,\n\n        -- Resolution type\n        case \n            when company_response_to_consumer ilike '%monetary%' then 'compensation'\n            when company_response_to_consumer ilike '%non-monetary%' then 'compensation'\n            when company_response_to_consumer ilike '%explanation%' then 'explanation'\n            when company_response_to_consumer ilike '%in progress%' then 'in_progress'\n            when company_response_to_consumer is null then 'no_response'\n            else 'other'\n        end as resolution_type,\n\n        -- Product group\n        case\n            when product like '%card%' then 'card'\n            when product like '%loan%' then 'loan'\n            when product like '%mortgage%' then 'mortgage'\n            when product like '%credit%' then 'credit'\n            else 'other'\n        end as product_group,\n\n        -- Time metric\n        (date_received - date_submitted) as response_days\n\n\n    from source\n    where complaint_id is not null\n)\n\nselect * from cleaned", "relation_name": "\"dev\".\"main\".\"stg_consumer_complaints\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.343503Z", "completed_at": "2025-05-28T18:38:48.346225Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.346486Z", "completed_at": "2025-05-28T18:38:48.361229Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01987481117248535, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.accepted_values_stg_consumer_complaints_contact_channel__digital__phone__other.5051ce79d4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        contact_channel as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"stg_consumer_complaints\"\n    group by contact_channel\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'digital','phone','other'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.365002Z", "completed_at": "2025-05-28T18:38:48.370297Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.370559Z", "completed_at": "2025-05-28T18:38:48.377005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013860464096069336, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.accepted_values_stg_consumer_complaints_resolution_type__compensation__explanation__in_progress__no_response__other.353c24a38e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        resolution_type as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"stg_consumer_complaints\"\n    group by resolution_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'compensation','explanation','in_progress','no_response','other'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.380110Z", "completed_at": "2025-05-28T18:38:48.385258Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.385651Z", "completed_at": "2025-05-28T18:38:48.391631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013170719146728516, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.not_null_stg_consumer_complaints_complaint_id.0215f5ce0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect complaint_id\nfrom \"dev\".\"main\".\"stg_consumer_complaints\"\nwhere complaint_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.394710Z", "completed_at": "2025-05-28T18:38:48.397567Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.397815Z", "completed_at": "2025-05-28T18:38:48.402255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009144306182861328, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.not_null_stg_consumer_complaints_date_received.93c385da63", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_received\nfrom \"dev\".\"main\".\"stg_consumer_complaints\"\nwhere date_received is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.405344Z", "completed_at": "2025-05-28T18:38:48.407979Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.408228Z", "completed_at": "2025-05-28T18:38:48.412664Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008977651596069336, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.not_null_stg_consumer_complaints_product.2311150918", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product\nfrom \"dev\".\"main\".\"stg_consumer_complaints\"\nwhere product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.415850Z", "completed_at": "2025-05-28T18:38:48.420528Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.420830Z", "completed_at": "2025-05-28T18:38:48.430445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01633477210998535, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.unique_stg_consumer_complaints_complaint_id.0b3cb0d4c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    complaint_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"stg_consumer_complaints\"\nwhere complaint_id is not null\ngroup by complaint_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.433934Z", "completed_at": "2025-05-28T18:38:48.435819Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.436077Z", "completed_at": "2025-05-28T18:38:48.458631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02550506591796875, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.consumer_complaints.mrt_monthly_summary", "compiled": true, "compiled_code": "-- Evoluci\u00f3n mensual de quejas + resoluci\u00f3n favorable\n\nwith source as (\n\n    select\n        date_trunc('month', date_received) as month,\n        product_group,\n        resolution_type\n    from \"dev\".\"main\".\"stg_consumer_complaints\"\n\n),\n\nms as (\n\n    select\n        month,\n        product_group,\n        count(*) as total_complaints,\n        sum(case when resolution_type in ('compensation', 'explanation') then 1 else 0 end) as resolved_favorably,\n        round(100.0 * sum(case when resolution_type in ('compensation', 'explanation') then 1 else 0 end) / count(*), 2) as pct_resolved_favorably\n    from source\n    group by 1, 2\n\n)\n\nselect * from ms", "relation_name": "\"dev\".\"main\".\"mrt_monthly_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.461535Z", "completed_at": "2025-05-28T18:38:48.463422Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.463658Z", "completed_at": "2025-05-28T18:38:48.482404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02165365219116211, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.consumer_complaints.mrt_state_resolution", "compiled": true, "compiled_code": "with source as (\n\n    select\n        state,\n        resolution_type\n    from \"dev\".\"main\".\"stg_consumer_complaints\"\n\n),\n\nsr as (\n\n    select\n        state,\n        count(*) as total_complaints,\n        sum(case when resolution_type = 'no_response' then 1 else 0 end) as no_response_count,\n        round(100.0 * sum(case when resolution_type = 'no_response' then 1 else 0 end) / count(*), 2) as pct_no_response\n    from source\n    group by 1\n\n)\n\nselect * from sr", "relation_name": "\"dev\".\"main\".\"mrt_state_resolution\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.484908Z", "completed_at": "2025-05-28T18:38:48.487763Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.488073Z", "completed_at": "2025-05-28T18:38:48.492414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009330272674560547, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.not_null_mrt_monthly_summary_month.f05556ae72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"dev\".\"main\".\"mrt_monthly_summary\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-28T18:38:48.495675Z", "completed_at": "2025-05-28T18:38:48.498647Z"}, {"name": "execute", "started_at": "2025-05-28T18:38:48.498918Z", "completed_at": "2025-05-28T18:38:48.503710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00974583625793457, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.consumer_complaints.not_null_mrt_state_resolution_state.a5d36ac884", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"dev\".\"main\".\"mrt_state_resolution\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.365036964416504, "args": {"quiet": false, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "log_format_file": "debug", "log_format": "default", "include_saved_query": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "require_nested_cumulative_type_params": false, "use_colors": true, "version_check": true, "show": false, "state_modified_compare_more_unrendered_values": false, "exclude_resource_types": [], "log_file_max_bytes": 10485760, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "export_saved_queries": false, "vars": {}, "use_colors_file": true, "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "defer": false, "cache_selected_only": false, "which": "build", "require_batched_execution_for_custom_microbatch_strategy": false, "indirect_selection": "eager", "resource_types": [], "static_parser": true, "strict_mode": false, "project_dir": "C:\\Users\\danie\\Desktop\\Consumer_Complaints", "populate_cache": true, "send_anonymous_usage_stats": true, "print": true, "partial_parse": true, "log_path": "C:\\Users\\danie\\Desktop\\Consumer_Complaints\\logs", "invocation_command": "dbt build --full-refresh", "select": [], "profiles_dir": "C:\\Users\\danie\\.dbt", "log_level": "info", "macro_debugging": false, "exclude": [], "empty": false, "write_json": true, "full_refresh": true, "require_resource_names_without_spaces": false, "introspect": true, "state_modified_compare_vars": false, "show_resource_report": false}}